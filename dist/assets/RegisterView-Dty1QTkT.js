import{g as Ve,r as C,o as Oe,w as B,i as M,a as T,b as Ee,c as _,u as o,d as Y,p as ee,e as je,f as Ie,n as te,h as H,j as J,k as Pe,l as Se,m as A,q as R,s as w,t as b,v as L,x as S,y as W,z as ce,A as z,B as Ae,C as ze,D as Be,E as Le,_ as Te}from"./index-DavOiVAl.js";function ne(t,r){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(t,a).enumerable})),e.push.apply(e,n)}return e}function O(t){for(var r=1;r<arguments.length;r++){var e=arguments[r]!=null?arguments[r]:{};r%2?ne(Object(e),!0).forEach(function(n){De(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):ne(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function De(t,r,e){return r in t?Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[r]=e,t}function re(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return Object.keys(t).reduce((e,n)=>(r.includes(n)||(e[n]=o(t[n])),e),{})}function k(t){return typeof t=="function"}function ke(t){return je(t)||Ie(t)}function de(t,r,e){let n=t;const a=r.split(".");for(let u=0;u<a.length;u++){if(!n[a[u]])return e;n=n[a[u]]}return n}function G(t,r,e){return _(()=>t.some(n=>de(r,n,{[e]:!1})[e]))}function ae(t,r,e){return _(()=>t.reduce((n,a)=>{const u=de(r,a,{[e]:!1})[e]||[];return n.concat(u)},[]))}function fe(t,r,e,n){return t.call(n,o(r),o(e),n)}function me(t){return t.$valid!==void 0?!t.$valid:!t}function Ne(t,r,e,n,a,u,h){let{$lazy:d,$rewardEarly:$}=a,c=arguments.length>7&&arguments[7]!==void 0?arguments[7]:[],l=arguments.length>8?arguments[8]:void 0,i=arguments.length>9?arguments[9]:void 0,g=arguments.length>10?arguments[10]:void 0;const v=C(!!n.value),s=C(0);e.value=!1;const m=B([r,n].concat(c,g),()=>{if(d&&!n.value||$&&!i.value&&!e.value)return;let f;try{f=fe(t,r,l,h)}catch(p){f=Promise.reject(p)}s.value++,e.value=!!s.value,v.value=!1,Promise.resolve(f).then(p=>{s.value--,e.value=!!s.value,u.value=p,v.value=me(p)}).catch(p=>{s.value--,e.value=!!s.value,u.value=p,v.value=!0})},{immediate:!0,deep:typeof r=="object"});return{$invalid:v,$unwatch:m}}function qe(t,r,e,n,a,u,h,d){let{$lazy:$,$rewardEarly:c}=n;const l=()=>({}),i=_(()=>{if($&&!e.value||c&&!d.value)return!1;let g=!0;try{const v=fe(t,r,h,u);a.value=v,g=me(v)}catch(v){a.value=v}return g});return{$unwatch:l,$invalid:i}}function Fe(t,r,e,n,a,u,h,d,$,c,l){const i=C(!1),g=t.$params||{},v=C(null);let s,m;t.$async?{$invalid:s,$unwatch:m}=Ne(t.$validator,r,i,e,n,v,a,t.$watchTargets,$,c,l):{$invalid:s,$unwatch:m}=qe(t.$validator,r,e,n,v,a,$,c);const f=t.$message;return{$message:k(f)?_(()=>f(re({$pending:i,$invalid:s,$params:re(g),$model:r,$response:v,$validator:u,$propertyPath:d,$property:h}))):f||"",$params:g,$pending:i,$invalid:s,$response:v,$unwatch:m}}function Ue(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r=o(t),e=Object.keys(r),n={},a={},u={};let h=null;return e.forEach(d=>{const $=r[d];switch(!0){case k($.$validator):n[d]=$;break;case k($):n[d]={$validator:$};break;case d==="$validationGroups":h=$;break;case d.startsWith("$"):u[d]=$;break;default:a[d]=$}}),{rules:n,nestedValidators:a,config:u,validationGroups:h}}const Ge="__root";function Me(t,r,e,n,a,u,h,d,$){const c=Object.keys(t),l=n.get(a,t),i=C(!1),g=C(!1),v=C(0);if(l){if(!l.$partial)return l;l.$unwatch(),i.value=l.$dirty.value}const s={$dirty:i,$path:a,$touch:()=>{i.value||(i.value=!0)},$reset:()=>{i.value&&(i.value=!1)},$commit:()=>{}};return c.length?(c.forEach(m=>{s[m]=Fe(t[m],r,s.$dirty,u,h,m,e,a,$,g,v)}),s.$externalResults=_(()=>d.value?[].concat(d.value).map((m,f)=>({$propertyPath:a,$property:e,$validator:"$externalResults",$uid:`${a}-externalResult-${f}`,$message:m,$params:{},$response:null,$pending:!1})):[]),s.$invalid=_(()=>{const m=c.some(f=>o(s[f].$invalid));return g.value=m,!!s.$externalResults.value.length||m}),s.$pending=_(()=>c.some(m=>o(s[m].$pending))),s.$error=_(()=>s.$dirty.value?s.$pending.value||s.$invalid.value:!1),s.$silentErrors=_(()=>c.filter(m=>o(s[m].$invalid)).map(m=>{const f=s[m];return T({$propertyPath:a,$property:e,$validator:m,$uid:`${a}-${m}`,$message:f.$message,$params:f.$params,$response:f.$response,$pending:f.$pending})}).concat(s.$externalResults.value)),s.$errors=_(()=>s.$dirty.value?s.$silentErrors.value:[]),s.$unwatch=()=>c.forEach(m=>{s[m].$unwatch()}),s.$commit=()=>{g.value=!0,v.value=Date.now()},n.set(a,t,s),s):(l&&n.set(a,t,s),s)}function We(t,r,e,n,a,u,h){const d=Object.keys(t);return d.length?d.reduce(($,c)=>($[c]=Z({validations:t[c],state:r,key:c,parentKey:e,resultsCache:n,globalConfig:a,instance:u,externalResults:h}),$),{}):{}}function Ze(t,r,e){const n=_(()=>[r,e].filter(s=>s).reduce((s,m)=>s.concat(Object.values(o(m))),[])),a=_({get(){return t.$dirty.value||(n.value.length?n.value.every(s=>s.$dirty):!1)},set(s){t.$dirty.value=s}}),u=_(()=>{const s=o(t.$silentErrors)||[],m=n.value.filter(f=>(o(f).$silentErrors||[]).length).reduce((f,p)=>f.concat(...p.$silentErrors),[]);return s.concat(m)}),h=_(()=>{const s=o(t.$errors)||[],m=n.value.filter(f=>(o(f).$errors||[]).length).reduce((f,p)=>f.concat(...p.$errors),[]);return s.concat(m)}),d=_(()=>n.value.some(s=>s.$invalid)||o(t.$invalid)||!1),$=_(()=>n.value.some(s=>o(s.$pending))||o(t.$pending)||!1),c=_(()=>n.value.some(s=>s.$dirty)||n.value.some(s=>s.$anyDirty)||a.value),l=_(()=>a.value?$.value||d.value:!1),i=()=>{t.$touch(),n.value.forEach(s=>{s.$touch()})},g=()=>{t.$commit(),n.value.forEach(s=>{s.$commit()})},v=()=>{t.$reset(),n.value.forEach(s=>{s.$reset()})};return n.value.length&&n.value.every(s=>s.$dirty)&&i(),{$dirty:a,$errors:h,$invalid:d,$anyDirty:c,$error:l,$pending:$,$touch:i,$reset:v,$silentErrors:u,$commit:g}}function Z(t){let{validations:r,state:e,key:n,parentKey:a,childResults:u,resultsCache:h,globalConfig:d={},instance:$,externalResults:c}=t;const l=a?`${a}.${n}`:n,{rules:i,nestedValidators:g,config:v,validationGroups:s}=Ue(r),m=O(O({},d),v),f=n?_(()=>{const y=o(e);return y?o(y[n]):void 0}):e,p=O({},o(c)||{}),x=_(()=>{const y=o(c);return n?y?o(y[n]):void 0:y}),K=Me(i,f,n,h,l,m,$,x,e),E=We(g,f,l,h,m,$,x),Q={};s&&Object.entries(s).forEach(y=>{let[j,V]=y;Q[j]={$invalid:G(V,E,"$invalid"),$error:G(V,E,"$error"),$pending:G(V,E,"$pending"),$errors:ae(V,E,"$errors"),$silentErrors:ae(V,E,"$silentErrors")}});const{$dirty:N,$errors:ge,$invalid:q,$anyDirty:he,$error:_e,$pending:F,$touch:U,$reset:ye,$silentErrors:be,$commit:X}=Ze(K,E,u),xe=n?_({get:()=>o(f),set:y=>{N.value=!0;const j=o(e),V=o(c);V&&(V[n]=p[n]),M(j[n])?j[n].value=y:j[n]=y}}):null;n&&m.$autoDirty&&B(f,()=>{N.value||U();const y=o(c);y&&(y[n]=p[n])},{flush:"sync"});async function Re(){return U(),m.$rewardEarly&&(X(),await te()),await te(),new Promise(y=>{if(!F.value)return y(!q.value);const j=B(F,()=>{y(!q.value),j()})})}function we(y){return(u.value||{})[y]}function Ce(){M(c)?c.value=p:Object.keys(p).length===0?Object.keys(c).forEach(y=>{delete c[y]}):Object.assign(c,p)}return T(O(O(O({},K),{},{$model:xe,$dirty:N,$error:_e,$errors:ge,$invalid:q,$anyDirty:he,$pending:F,$touch:U,$reset:ye,$path:l||Ge,$silentErrors:be,$validate:Re,$commit:X},u&&{$getResultsForChild:we,$clearExternalResults:Ce,$validationGroups:Q}),E))}class He{constructor(){this.storage=new Map}set(r,e,n){this.storage.set(r,{rules:e,result:n})}checkRulesValidity(r,e,n){const a=Object.keys(n),u=Object.keys(e);return u.length!==a.length||!u.every(d=>a.includes(d))?!1:u.every(d=>e[d].$params?Object.keys(e[d].$params).every($=>o(n[d].$params[$])===o(e[d].$params[$])):!0)}get(r,e){const n=this.storage.get(r);if(!n)return;const{rules:a,result:u}=n,h=this.checkRulesValidity(r,e,a),d=u.$unwatch?u.$unwatch:()=>({});return h?u:{$dirty:u.$dirty,$partial:!0,$unwatch:d}}}const D={COLLECT_ALL:!0,COLLECT_NONE:!1},se=Symbol("vuelidate#injectChildResults"),oe=Symbol("vuelidate#removeChildResults");function Je(t){let{$scope:r,instance:e}=t;const n={},a=C([]),u=_(()=>a.value.reduce((l,i)=>(l[i]=o(n[i]),l),{}));function h(l,i){let{$registerAs:g,$scope:v,$stopPropagation:s}=i;s||r===D.COLLECT_NONE||v===D.COLLECT_NONE||r!==D.COLLECT_ALL&&r!==v||(n[g]=l,a.value.push(g))}e.__vuelidateInjectInstances=[].concat(e.__vuelidateInjectInstances||[],h);function d(l){a.value=a.value.filter(i=>i!==l),delete n[l]}e.__vuelidateRemoveInstances=[].concat(e.__vuelidateRemoveInstances||[],d);const $=Y(se,[]);ee(se,e.__vuelidateInjectInstances);const c=Y(oe,[]);return ee(oe,e.__vuelidateRemoveInstances),{childResults:u,sendValidationResultsToParent:$,removeValidationResultsFromParent:c}}function $e(t){return new Proxy(t,{get(r,e){return typeof r[e]=="object"?$e(r[e]):_(()=>r[e])}})}let le=0;function pe(t,r){var e;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};arguments.length===1&&(n=t,t=void 0,r=void 0);let{$registerAs:a,$scope:u=D.COLLECT_ALL,$stopPropagation:h,$externalResults:d,currentVueInstance:$}=n;const c=$||((e=Ve())===null||e===void 0?void 0:e.proxy),l=c?c.$options:{};a||(le+=1,a=`_vuelidate_${le}`);const i=C({}),g=new He,{childResults:v,sendValidationResultsToParent:s,removeValidationResultsFromParent:m}=c?Je({$scope:u,instance:c}):{childResults:C({})};if(!t&&l.validations){const f=l.validations;r=C({}),Oe(()=>{r.value=c,B(()=>k(f)?f.call(r.value,new $e(r.value)):f,p=>{i.value=Z({validations:p,state:r,childResults:v,resultsCache:g,globalConfig:n,instance:c,externalResults:d||c.vuelidateExternalResults})},{immediate:!0})}),n=l.validationsConfig||n}else{const f=M(t)||ke(t)?t:T(t||{});B(f,p=>{i.value=Z({validations:p,state:r,childResults:v,resultsCache:g,globalConfig:n,instance:c??{},externalResults:d})},{immediate:!0})}return c&&(s.forEach(f=>f(i,{$registerAs:a,$scope:u,$stopPropagation:h})),Ee(()=>m.forEach(f=>f(a)))),_(()=>O(O({},o(i.value)),v.value))}const ve=t=>{if(t=o(t),Array.isArray(t))return!!t.length;if(t==null)return!1;if(t===!1)return!0;if(t instanceof Date)return!isNaN(t.getTime());if(typeof t=="object"){for(let r in t)return!0;return!1}return!!String(t).length};function P(){for(var t=arguments.length,r=new Array(t),e=0;e<t;e++)r[e]=arguments[e];return n=>(n=o(n),!ve(n)||r.every(a=>(a.lastIndex=0,a.test(n))))}P(/^[a-zA-Z]*$/);P(/^[a-zA-Z0-9]*$/);P(/^\d*(\.\d+)?$/);const Ke=/^(?:[A-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[A-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9]{2,}(?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])$/i;P(Ke);function Qe(t){return typeof t=="string"&&(t=t.trim()),ve(t)}var I={$validator:Qe,$message:"Value is required",$params:{type:"required"}};const Xe=/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)+(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/i;P(Xe);P(/(^[0-9]*$)|(^-[0-9]+$)/);P(/^[-]?\d*(\.\d+)?$/);const ue={name:"",country:"",population:0,softDelete:!1},ie={title:"",description:"",rating:0,recomendation:!1},Ye=H({__name:"AppRegisterCity",setup(t){const{t:r}=J(),e=T({...ue}),a=pe({name:{required:I},country:{required:I},population:{required:I}},e),u=Pe();async function h(){if(a.value.$touch(),a.value.$invalid){console.log("Formulario no válido");return}const l=$();console.log(l);try{if(c(l.nombre,l.pais))throw W(r("duplicated"),{type:"error",onClose:()=>{e.name=""}}),new Error("Esta ciudad ya está registrada");const i=await u.addCity(l);W(r(i.message),{type:i.success?"success":"error",onClose:()=>{d(),i.success&&ce.push("/")}})}catch(i){console.log("Error:",i)}}function d(){a.value.$reset(),Object.assign(e,ue)}function $(){return{nombre:e.name,pais:e.country,poblacion:e.population,softDelete:e.softDelete}}function c(l,i){return u.cities.some(g=>g.nombre===l&&g.pais===i)}return Se(async()=>{await u.fetchAll(),console.log(u.cities)}),(l,i)=>{const g=R("v-text-field"),v=R("v-btn"),s=R("v-form"),m=R("v-card"),f=R("v-container");return z(),A(f,null,{default:w(()=>[b(m,{class:"mx-auto px-6 py-8","max-width":"350"},{default:w(()=>[b(s,null,{default:w(()=>[b(g,{modelValue:e.name,"onUpdate:modelValue":i[0]||(i[0]=p=>e.name=p),counter:10,"error-messages":o(a).name.$errors.map(p=>String(p.$message)),label:o(r)("name"),required:"",onBlur:o(a).name.$touch,onInput:o(a).name.$touch,class:"mb-2"},null,8,["modelValue","error-messages","label","onBlur","onInput"]),b(g,{modelValue:e.country,"onUpdate:modelValue":i[1]||(i[1]=p=>e.country=p),"error-messages":o(a).country.$errors.map(p=>String(p.$message)),label:o(r)("country"),required:"",onBlur:o(a).country.$touch,onInput:o(a).country.$touch,class:"mb-2"},null,8,["modelValue","error-messages","label","onBlur","onInput"]),b(g,{modelValue:e.population,"onUpdate:modelValue":i[2]||(i[2]=p=>e.population=p),"error-messages":o(a).population.$errors.map(p=>String(p.$message)),label:o(r)("population"),required:"",onBlur:o(a).population.$touch,onInput:o(a).population.$touch,class:"mb-2"},null,8,["modelValue","error-messages","label","onBlur","onInput"]),b(v,{class:"me-4",onClick:h},{default:w(()=>[L(S(o(r)("confirm")),1)]),_:1}),b(v,{onClick:d},{default:w(()=>[L(S(o(r)("clean")),1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),et=H({__name:"AppRegisterResena",setup(t){const{t:r}=J(),e=T({...ie}),a=pe({title:{required:I},description:{required:I},rating:{required:I},recomendation:{required:I}},e),u=Ae();async function h(){if(a.value.$touch(),a.value.$invalid){console.log("Formulario no válido");return}const c=$(),l=await u.addResena(c);W(r(l.message),{type:l.success?"success":"error",onClose:()=>{d(),l.success&&ce.push(`/cities/${c.ciudadId}`)}})}function d(){a.value.$reset(),Object.assign(e,ie)}function $(){return{ciudadId:1,titulo:e.title,descripcion:e.description,calificacion:e.rating,recomendacion:e.recomendation}}return(c,l)=>{const i=R("v-text-field"),g=R("v-radio"),v=R("v-radio-group"),s=R("v-btn"),m=R("v-form"),f=R("v-card"),p=R("v-container");return z(),A(p,null,{default:w(()=>[b(f,{class:"mx-auto px-6 py-8","max-width":"350"},{default:w(()=>[b(m,null,{default:w(()=>[b(i,{modelValue:e.title,"onUpdate:modelValue":l[0]||(l[0]=x=>e.title=x),counter:10,"error-messages":o(a).title.$errors.map(x=>String(x.$message)),label:o(r)("title"),required:"",onBlur:o(a).title.$touch,onInput:o(a).title.$touch,class:"mb-2"},null,8,["modelValue","error-messages","label","onBlur","onInput"]),b(i,{modelValue:e.description,"onUpdate:modelValue":l[1]||(l[1]=x=>e.description=x),"error-messages":o(a).description.$errors.map(x=>String(x.$message)),label:o(r)("description"),required:"",onBlur:o(a).description.$touch,onInput:o(a).description.$touch,class:"mb-2"},null,8,["modelValue","error-messages","label","onBlur","onInput"]),b(i,{type:"number",modelValue:e.rating,"onUpdate:modelValue":l[2]||(l[2]=x=>e.rating=x),"error-messages":o(a).rating.$errors.map(x=>String(x.$message)),label:o(r)("rating"),required:"",onBlur:o(a).rating.$touch,onInput:o(a).rating.$touch,class:"mb-2",max:5,min:0},null,8,["modelValue","error-messages","label","onBlur","onInput"]),b(v,{modelValue:e.recomendation,"onUpdate:modelValue":l[3]||(l[3]=x=>e.recomendation=x),label:o(r)("isRecomended"),class:"mb-2"},{default:w(()=>[b(g,{label:o(r)("si"),value:!0},null,8,["label"]),b(g,{label:o(r)("no"),value:!1},null,8,["label"])]),_:1},8,["modelValue","label"]),b(s,{class:"me-4",onClick:h},{default:w(()=>[L(S(o(r)("confirm")),1)]),_:1}),b(s,{onClick:d},{default:w(()=>[L(S(o(r)("clean")),1)]),_:1})]),_:1})]),_:1})]),_:1})}}}),tt={class:"text-h4 text-md-h3 mb-6 mb-md-10 text-center mt-3 mt-md-10"},nt=H({__name:"RegisterView",setup(t){const r=Le(),e=ze(),{t:n}=J();return console.log("Tipo en params:",e.params.tipo),(a,u)=>{const h=R("v-btn"),d=R("v-container");return z(),A(d,{class:"fill-height d-flex flex-column align-center container"},{default:w(()=>[Be("h1",tt,S(o(n)("register")),1),o(e).params.tipo==="city"?(z(),A(Ye,{key:0})):(z(),A(et,{key:1})),b(h,{onClick:u[0]||(u[0]=$=>o(r).back()),class:"container__button elevation-4 rounded-xl mt-6 mx-auto"},{default:w(()=>[L(S(o(n)("back")),1)]),_:1})]),_:1})}}}),at=Te(nt,[["__scopeId","data-v-d448ecbb"]]);export{at as default};
